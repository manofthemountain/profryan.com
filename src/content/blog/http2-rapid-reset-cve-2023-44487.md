---
title: "HTTP/2 Rapid Reset (CVE-2023-44487): Protocol Semantics Weaponized"
description: "A technical breakdown of the HTTP/2 Rapid Reset vulnerability (CVE-2023-44487), how it enabled record-breaking DDoS attacks, and what it means for modern Layer 7 defense strategies."
pubDate: "2023-10-13"
heroImage: "/images/blog/http2-rapid-reset/http2-rapid-reset-figure1.jpg"
heroImageAlt: "HTTP/1.1 vs HTTP/2 request and response pattern comparison."
---

In late 2023, one of the largest distributed denial-of-service (DDoS) campaigns in Internet history leveraged a protocol-level weakness in HTTP/2. The vulnerability — **CVE-2023-44487**, commonly known as *HTTP/2 Rapid Reset* — did not rely on amplification or bandwidth saturation.

It exploited protocol logic.

---

## HTTP/1.1 vs HTTP/2 Multiplexing

HTTP/2 introduced **multiplexing**, allowing multiple concurrent request streams over a single TCP connection.

In HTTP/1.1:
- One request effectively blocks the next
- Head-of-line blocking
- Heavy reliance on multiple connections

In HTTP/2:
- Multiple independent streams per connection
- Framed messages
- Improved performance and reduced latency

![Figure 1: HTTP/1.1 and HTTP/2 request and response pattern (Courtesy of Google)](/images/blog/http2-rapid-reset/http2-rapid-reset-figure1.jpg)

*Figure 1. HTTP/1.1 and HTTP/2 request and response pattern (Courtesy of Google)*

Multiplexing improved performance dramatically — but it changed server-side resource accounting.

---

## The Core Mechanism: RST_STREAM Abuse

HTTP/2 allows a client to cancel a request stream using the `RST_STREAM` frame.

Normal lifecycle:

1. Client sends `HEADERS`
2. Stream transitions from `idle → open`
3. `END_STREAM` moves state toward half-closed
4. Server processes request
5. Response completes stream

Rapid Reset behavior:

1. Client sends `HEADERS`
2. Immediately sends `RST_STREAM`
3. Server begins processing
4. Stream closes before response
5. Client instantly opens another stream

![Figure 2: HTTP/2 stream state transitions (Courtesy of Cloudflare)](/images/blog/http2-rapid-reset/http2-rapid-reset-figure2.jpg)

*Figure 2. Requests stream diagram (Courtesy of Cloudflare)*

The critical insight:

> When a client cancels a stream, it instantly regains the ability to open another stream.

Because concurrency limits apply to active streams, rapidly closed streams allow attackers to avoid hitting thresholds while still forcing server work.

---

## Real-World Exploitation

This vulnerability was actively exploited between August and October 2023.

Targets included:
- Google
- AWS
- Cloudflare

Reported peaks exceeded hundreds of millions of requests per second.

Unlike volumetric DDoS attacks, Rapid Reset:
- Does not rely on bandwidth saturation
- Exploits application-layer processing
- Scales efficiently per TCP connection
- Focuses on CPU and request handling exhaustion

---

## Detecting Vulnerable Servers

A public testing tool was released to identify vulnerable implementations.

The detection process:

1. Establish HTTP/2 connection
2. Open a stream
3. Immediately reset it
4. Observe whether the server enforces limits

![Figure 3: Command-line output enumerating vulnerable assets](/images/blog/http2-rapid-reset/http2-rapid-reset-figure3.jpg)

*Figure 3. Command-line output of enumerating vulnerable assets*

If the server allows continuous rapid creation and cancellation of streams without throttling or termination, it may be vulnerable.

---

## Mitigation Strategies

Effective defense requires protocol-aware controls:

### 1. Reset-Aware Rate Limiting
Monitor abnormal reset-to-completion ratios.

### 2. Stream Lifetime Controls
Enforce maximum streams per connection and terminate abusive connections.

### 3. Edge-Level L7 Protection
Use reverse proxies, adaptive filtering, and intelligent request shaping.

Major vendors patched implementations to properly account for rapid resets and enforce connection termination under abuse conditions.

---

## Strategic Takeaways

CVE-2023-44487 demonstrates:

- Protocol semantics can be weaponized
- Performance optimizations expand attack surface
- Concurrency limits alone are insufficient
- Application-layer DDoS is increasingly logic-driven

Modern defense must monitor:

- Stream lifecycle behavior
- Cancellation frequency
- CPU-bound exhaustion patterns
- Application-layer economics

HTTP/2 Rapid Reset is a reminder that performance and security evolve together.

---

## References

Cloudflare – HTTP/2 Rapid Reset Analysis  
https://blog.cloudflare.com/technical-breakdown-http2-rapid-reset-ddos-attack/

Google – The Novel HTTP/2 Rapid Reset DDoS Attack  
https://cloud.google.com/blog/products/identity-security/how-it-works-the-novel-http2-rapid-reset-ddos-attack

AWS Advisory – CVE-2023-44487  
https://aws.amazon.com/security/security-bulletins/AWS-2023-011/

NGINX Impact Notice  
https://www.nginx.com/blog/http-2-rapid-reset-attack-impacting-nginx-products/

Microsoft Response  
https://msrc.microsoft.com/blog/2023/10/microsoft-response-to-distributed-denial-of-service-ddos-attacks-against-http-2/

CVE Record  
https://www.cve.org/CVERecord?id=CVE-2023-44487

Detection Tool  
https://github.com/bcdannyboy/CVE-2023-44487/